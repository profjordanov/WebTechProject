if (self.CavalryLogger) { CavalryLogger.start_js(["KVaP4"]); }

__d('EmojiInputButton.react',['fbt','Bootloader','FocusRelocator.react','Link.react','React','createCancelableFunction','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=null;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(m){j.constructor.call(this,m);this.$EmojiInputButton4=function(event){event.preventDefault();event.stopPropagation();this.props.onClick&&this.props.onClick();this.setState({locked:false,visible:!this.state.locked?!this.state.visible:false});}.bind(this);this.$EmojiInputButton5=function(event){this.setState({locked:this.state.visible});}.bind(this);this.$EmojiInputButton7=function(n){if(!n)this.setState({visible:false});}.bind(this);this.state={locked:false,visible:false};}l.prototype.componentWillUnmount=function(){this.$EmojiInputButton1&&this.$EmojiInputButton1.cancel();this.$EmojiInputButton1=null;};l.prototype.render=function(){var m=h._("Insert an emoji"),n=this.state.visible?c('joinClasses')(this.props.iconActiveClassName,this.props.iconClassName):this.props.iconClassName;return c('React').createElement(c('FocusRelocator.react'),{from:this.$EmojiInputButton3,to:this.$EmojiInputButton2},c('React').createElement(c('Link.react'),{'aria-label':m,className:this.props.buttonClassName,'data-hover':'tooltip','data-tooltip-alignh':'center','data-tooltip-content':!this.state.visible?m:null,onClick:this.$EmojiInputButton4,onDragStart:function o(p){return p.preventDefault();},onMouseDown:this.$EmojiInputButton5,linkRef:function(o){return this.$EmojiInputButton3=o;}.bind(this),role:'button'},c('React').createElement('div',{className:n,ref:function(o){return this.$EmojiInputButton2=o;}.bind(this)}),this.$EmojiInputButton6()));};l.prototype.$EmojiInputButton6=function(){if(!k){if(this.state.visible){this.$EmojiInputButton1=c('createCancelableFunction')(function(){this.forceUpdate();}.bind(this));c('Bootloader').loadModules(["EmojiPicker.react"],function(m){k=m;if(this.$EmojiInputButton1){this.$EmojiInputButton1();this.$EmojiInputButton1=null;}}.bind(this),'EmojiInputButton.react');}return null;}return c('React').createElement(k,{context:this.$EmojiInputButton3,onToggle:this.$EmojiInputButton7,onSelect:this.props.onSelect,shown:this.state.visible});};f.exports=l;}),null);
__d('BlueBarFixedBehaviorController',['Arbiter','Bootloader'],(function a(b,c,d,e,f,g){f.exports={init:function h(i){if(!('getBoundingClientRect' in i))return;var j=void 0,k=document.documentElement;function l(){var m=i.getBoundingClientRect(),n=m.top,o=Math.round(n)-k.clientTop<=0;if(j!==o){j=o;c('Arbiter').inform('bluebarFixedBehaviorController/isfixed',j,c('Arbiter').BEHAVIOR_STATE);}}l();c('Bootloader').loadModules(["Event"],function(m){m.listen(window,'scroll',l);},'BlueBarFixedBehaviorController');}};}),null);
__d("XPhotosWaterfallBatchLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/photos\/logging\/waterfall\/batch\/",{});}),null);
__d('PhotosUploadWaterfall',['AsyncRequest','AsyncSignal','Banzai','PhotosUploadWaterfallXConfig','XPhotosWaterfallBatchLoggingController','emptyFunction','randomInt','throttle'],(function a(b,c,d,e,f,g){var h=[],i={APP_SIMPLE:'simple',APP_ARCHIVE:'archive',APP_COMPOSER:'composer',APP_MESSENGER:'messenger',APP_HTML5:'html5',APP_CHAT:'chat',INSTALL_CANCEL:1,INSTALL_INSTALL:2,INSTALL_UPDATE:3,INSTALL_REINSTALL:4,INSTALL_PERMA_CANCEL:5,INSTALL_SILENT_SKIP:6,INSTALL_DOWNLOAD:7,CERROR_RESIZING_FAILED:6,CERROR_MARKER_EXTRACTION_FAILED:9,BEGIN:1,UPLOAD_START:4,ALL_UPLOADS_DONE:6,CLIENT_ERROR:7,RECOVERABLE_CLIENT_ERROR:12,IMAGES_SELECTED:9,UPGRADE_REQUIRED:11,VERSION:15,SELECT_START:18,SELECT_CANCELED:19,CANCEL:22,CANCEL_DURING_UPLOAD:83,ONE_RESIZING_START:2,ONE_UPLOAD_START:10,ONE_UPLOAD_DONE:29,ONE_RESIZING_DONE:34,PROGRESS_BAR_STOPPED:44,MISSED_BEAT:45,HEART_ATTACK:46,PUBLISH_SENT:99,PUBLISH_START:100,PUBLISH_SUCCESS:101,PUBLISH_FAILURE:102,CLUSTERING_START:103,CLUSTERING_SUCCESS:104,CLUSTERING_FAILURE:105,POST_BUTTON_CLICKED:110,POST_BUTTON_ERROR:111,PHOTO_DELETED:114,PUBLISH_CLIENT_SUCCESS:115,PHOTO_ROTATED:117,SAVE_DRAFT_BUTTON_CLICKED:123,RECOVERY_START_ON_CLIENT:124,CHANGE_PHOTO_QUALITY_SETTING:126,TAG_ADDED:127,TAG_REMOVED:128,TAB_BUTTON_CLICKED:129,DONE_SPHERICAL_CHECK:131,FAIL_SPHERICAL_CHECK:133,EDITABLE_PHOTO_FETCH_START:106,EDITABLE_PHOTO_FETCH_SUCCESS:107,EDITABLE_PHOTO_FETCH_FAILURE:108,EDITABLE_PHOTO_FETCH_DELAY:116,CANCEL_INDIVIDUAL_UPLOAD:109,MISSING_OVERLAY_NODE:118,PUBLISH_RETRY_FAILURE:119,MISSING_UPLOAD_STATE:120,SESSION_POSTED:72,POST_PUBLISHED:80,ONE_UPLOAD_CANCELED:81,ONE_UPLOAD_CANCELED_DURING_UPLOAD:82,RESIZER_AVAILABLE:20,OVERLAY_FIRST:61,ASYNC_AVAILABLE:63,FALLBACK_TO_HTML5:130,RETRY_UPLOAD:17,TAGGED_ALL_FACES:14,VAULT_IMAGES_SELECTED:62,VAULT_CREATE_POST_CANCEL:65,VAULT_SEND_IN_MESSAGE_CLICKED:66,VAULT_DELETE_CANCEL:68,VAULT_ADD_TO_ALBUM_CANCEL:74,VAULT_SHARE_IN_AN_ALBUM_CLICKED:76,VAULT_SHARE_OWN_TIMELINE_CLICKED:77,VAULT_SHARE_FRIENDS_TIMELINE_CLICKED:78,VAULT_SHARE_IN_A_GROUP_CLICKED:79,VAULT_SYNCED_PAGED_LINK_CLICKED:84,VAULTBOX:'vaultbox',GRID:'grid',SPOTLIGHT_VAULT_VIEWER:'spotlight_vault_viewer',REF_VAULT_NOTIFICATION:'vault_notification',_checkRequiredFields:function k(l){},sendBanzai:function k(l,m){this._checkRequiredFields(l);var n={};l.scuba_ints=l.scuba_ints||{};l.scuba_ints.client_time=Math.round(Date.now()/1000);if(c('PhotosUploadWaterfallXConfig').retryBanzai){n.retry=true;l.scuba_ints.nonce=c('randomInt')(4294967296);}c('Banzai').post(c('PhotosUploadWaterfallXConfig').deprecatedBanzaiRoute,l,n);if(m)setTimeout(m,0);},sendSignal:function k(l,m){this._checkRequiredFields(l);if(c('PhotosUploadWaterfallXConfig').useBanzai){this.sendBanzai(l,m);}else{var n=new (c('AsyncSignal'))('/ajax/photos/waterfall.php',{data:JSON.stringify(l)}).setHandler(m);if(c('PhotosUploadWaterfallXConfig').timeout)n.setTimeout(10*1000);n.send();}},queueLog:function k(l,m){h.push(l);if(!!m){this.flushQueue(m);}else j();},flushQueue:function k(l){var m=JSON.stringify(h);h=[];var n=c('XPhotosWaterfallBatchLoggingController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(n).setData({logs:m}).setFinallyHandler(l||c('emptyFunction')).setTimeoutHandler(10*1000,l||c('emptyFunction')).send();}},j=c('throttle')(i.flushQueue,c('PhotosUploadWaterfallXConfig').batchInterval*1000);f.exports=i;}),null);
__d('AlbumMediaUploadUtils',['VideoUploadConfig'],(function a(b,c,d,e,f,g){var h={isVideoFile:function i(j){var k=j.name,l=c('VideoUploadConfig').videoExtensions,m=k.indexOf('.')!==-1?k.split('.').pop().toLowerCase():'';return l[m];},hasVideos:function i(j){return this._filterVideos(j).length>0;},_filterVideos:function i(j){return this._filterFileOfSupportedType(j,c('VideoUploadConfig').videoExtensions);},_filterFileOfSupportedType:function i(j,k){return j.filter(function(l){var m=l.indexOf('.')!==-1?l.split('.').pop().toLowerCase():'';return k[m];});}};f.exports=h;}),null);
__d('FilePickerEvent',[],(function a(b,c,d,e,f,g){f.exports={BEGIN:'FilePickerEvent/BEGIN',SELECT_START:'FilePickerEvent/SELECT_START',SELECTED:'FilePickerEvent/SELECTED_FILES',ALBUM_LIMIT_EXCEEDED:'FilePickerEvent/ALBUM_LIMIT_EXCEEDED',SESSION_LIMIT_EXCEEDED:'FilePickerEvent/SESSION_LIMIT_EXCEEDED',SELECT_CANCELED:'FilePickerEvent/SELECT_CANCELED',FALLBACK:'FilePickerEvent/FALLBACK'};}),null);
__d('UploadSession',['invariant','AlbumMediaUploadUtils','AsyncRequest','FilePickerEvent','SubscriptionsHandler','PhotosUploadWaterfall','PUWSteps','URI','arrayContains'],(function a(b,c,d,e,f,g,h){var i={};function j(m){'use strict';this._sessionID=m;this._asyncBootstrapped=false;this._controller=null;this._overlay=null;this._pickers=[];this._pendingPhotoFileLists=[];this._pendingVideoFileLists=[];this._beginLogged=false;this._albumLimitWasExceeded=false;this._sessionLimitWasExceeded=false;this._subscriptions=new (c('SubscriptionsHandler'))();}j.prototype.addFilePicker=function(m){'use strict';if(!c('arrayContains')(this._pickers,m)){this._pickers.push(m);if(this._controller&&m.getSwfID&&m.getSwfID())this._controller.preregisterSwf&&this._controller.preregisterSwf(m.getSwfID());this._subscriptions.addSubscriptions(m.subscribe(c('FilePickerEvent').BEGIN,function(n,o){if(!this._beginLogged){this._beginLogged=true;m.logWaterfallStep(c('PhotosUploadWaterfall').BEGIN);m.logStep(c('PUWSteps').CLIENT_FLOW_BEGIN);}}.bind(this)),m.subscribe(c('FilePickerEvent').SELECTED,function(n,o){m.logStep(c('PUWSteps').CLIENT_SELECT_SUCCESS,{volume:o.files.length});var p=[],q=[];o.files.forEach(function(t){if(c('AlbumMediaUploadUtils').isVideoFile(t)){p.push(t);}else q.push(t);});if(this._controller){if(q.length>0)this._controller.uploadFiles(q);if(this._videoController&&p.length>0)this._videoController.uploadFiles(p);}else{if(q.length>0)this._pendingPhotoFileLists.push(q);if(p.length>0)this._pendingVideoFileLists.push(p);}if(this._asyncBootstrapped)return;var r=m._button,s=new (c('URI'))(r.getAttribute('ajaxify'));s.addQueryData('num_selected',o.files.length);c('AsyncRequest').bootstrap(s.toString(),r,true);this._asyncBootstrapped=true;}.bind(this)),m.subscribe(c('FilePickerEvent').SELECT_START,function(){m.logStep(c('PUWSteps').CLIENT_SELECT_BEGIN);}.bind(this)),m.subscribe(c('FilePickerEvent').SELECT_CANCELED,function(){m.logStep(c('PUWSteps').CLIENT_SELECT_CANCEL);if(!this._overlay){m.logStep(c('PUWSteps').CLIENT_FLOW_CANCEL);this._beginLogged=false;}}.bind(this)),m.subscribe(c('FilePickerEvent').ALBUM_LIMIT_EXCEEDED,function(){if(this._controller){this._controller.albumLimitExceeded();}else this._albumLimitWasExceeded=true;}.bind(this)),m.subscribe(c('FilePickerEvent').SESSION_LIMIT_EXCEEDED,function(){if(this._controller){this._controller.sessionLimitExceeded();}else this._sessionLimitWasExceeded=true;}.bind(this)));}};j.prototype.addController=function(m,n){'use strict';this._controller=m;this._videoController=n;this._asyncBootstrapped=true;var o=this._controller.getWaterfallID?this._controller.getWaterfallID():this._controller.getWaterfallConfig().waterfallID,p=this._controller.getUploaderApp?this._controller.getUploaderApp():this._controller.getWaterfallConfig().waterfallApp;if(!this._beginLogged){this._beginLogged=true;c('PhotosUploadWaterfall').sendSignal({qn:o,step:c('PhotosUploadWaterfall').BEGIN,uploader:p});}if(this._pendingPhotoFileLists.length>0||this._pendingVideoFileLists.length>0){var q=[],r=[];this._pendingVideoFileLists.forEach(function(s){r=r.concat(s);});this._pendingPhotoFileLists.forEach(function(s){q=q.concat(s);});if(q.length>0)this._controller.uploadFiles(q);if(r.length>0)this._videoController.uploadFiles(r);}else c('PhotosUploadWaterfall').sendSignal({qn:o,step:c('PhotosUploadWaterfall').OVERLAY_FIRST,uploader:p});if(this._albumLimitWasExceeded)this._controller.albumLimitExceeded();if(this._sessionLimitWasExceeded)this._controller.sessionLimitExceeded();};j.prototype.addOverlay=function(m){'use strict';this._overlay=m;};j.prototype.addOverlayAndController=function(m,n){'use strict';this.addOverlay(m);this.addController(n,null);};j.prototype.getFilePickers=function(){'use strict';return this._pickers;};j.prototype.cleanup=function(){'use strict';this._subscriptions&&this._subscriptions.release();};j.addFilePickerToSession=function(m,n){'use strict';k(m).addFilePicker(n);};j.addControllerToSession=function(m,n,o){'use strict';k(m).addController(n,o);};j.addOverlayToSession=function(m,n){'use strict';k(m).addOverlay(n);};j.addOverlayAndControllerToSession=function(m,n,o){'use strict';k(m).addOverlayAndController(n,o);};j.restartSessionPersistingFilePickers=function(m){'use strict';var n=k(m),o=new j(m);n.getFilePickers().forEach(function(p){o.addFilePicker(p);});l(m,o);};function k(m){if(!i[m])i[m]=new j(m);return i[m];}function l(m,n){i[m]||h(0);i[m].cleanup();delete i[m];i[m]=n;}f.exports=j;}),null);
__d('replaceNativeTimer',['clearInterval','clearTimeout','setInterval','setTimeout','requestAnimationFrame','cancelAnimationFrame'],(function a(b,c,d,e,f,g){c('setTimeout').nativeBackup=b.setTimeout;c('clearTimeout').nativeBackup=b.clearTimeout;c('setInterval').nativeBackup=b.setInterval;c('clearInterval').nativeBackup=b.clearInterval;c('requestAnimationFrame').nativeBackup=b.requestAnimationFrame;c('cancelAnimationFrame').nativeBackup=b.cancelAnimationFrame;b.setTimeout=c('setTimeout');b.clearTimeout=c('clearTimeout');b.setInterval=c('setInterval');b.clearInterval=c('clearInterval');b.requestAnimationFrame=c('requestAnimationFrame');}),18);